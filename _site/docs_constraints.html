<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Constraints</title>
    <meta name="description"
          content="OpenMapKitWebsite is the website for the OpenMapKit project. We are moving all training material within the wiki to the website
">

    <link rel="apple-touch-icon" sizes="57x57" href="../images/favicon/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../images/favicon/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../images/favicon/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../images/favicon/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../images/favicon/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../images/favicon/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="../images/favicon/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="../images/favicon/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="../images/favicon/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="192x192"  href="../images/favicon/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="../images/favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="../images/favicon/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="../images/favicon/favicon-16x16.png">
<link rel="manifest" href="../images/favicon/manifest.json">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="..images/favicon/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">

    <link rel="stylesheet" href="css/foundation.css">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/fontello.css">
    <link rel="stylesheet" href="css/fonts.css">
    <link rel="stylesheet" href="css/custom.css">
    <link rel="stylesheet" href="css/font-awesome.css">
    <link rel="stylesheet" href="css/home-nav.css">

    <script src="javascripts/libs.js" type="text/javascript"></script>
    <script >
        // terrificjs bootstrap
    (function ($) {
        $(document).ready(function () {
            var $page = $('body');
            var config = {
                dependencyPath: {
                    plugin: 'javascripts/'
                }
            }
            var application = new Tc.Application($page, config);
            application.registerModules();
            application.start();
        });
    })(Tc.$);
    </script>

    <script src="javascripts/masonry.pkgd.js" type="text/javascript"></script>
    <script src="javascripts/slick.min.js" type="text/javascript"></script>

</head>

<head>

    <!-- Styles -->
    <link rel="stylesheet" href="css/theDocs.all.min.css">
    <link rel="stylesheet" href="css/custom.css">
    <link rel="stylesheet" href="css/docs.css">

</head>


<body>

<div class='contain-to-grid sticky fixed'>
    <nav class='top-bar docs-nav-width' data-options='sticky_on: large' data-topbar=''>

        <ul class='title-area'>
            <li class='name'>
                <h1>
                    <a href='index.html'>
                        <div class="icn-logo_OMK"></div>
                    </a>
                </h1>
            </li>

            <li class="custom-topbar">
                <button type="button" class="custom-nav navbar-toggle for-sidebar" data-toggle="offcanvas">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            </li>

        </ul>
        <section class='top-bar-section'>
            <ul class="right">
                
                

                
                <li class="">
                    <a href="index.html">Home</a>
                </li>
                
                
                

                
                <li class="">
                    <a href="docs.html">Documentation</a>
                </li>
                
                
            </ul>
        </section>
    </nav>
</div>


<div role='main'>
    <div class="row">

    <!-- Sidebar -->
<aside id="new-sidebar">

    <div id="sideBar" class="new-sidebar-content">
        <ul class="">
        

        <li>
            <a href="index.html">Home</a>
            
            
        </li>

        

        <li>
            <a href="docs.html">Documentation</a>
            
            <ul class="open">
                
                <li class="" id="Users">
                    
                        <a href="#"> Users</a>
                    
                    <ul class="open">
                        
                        <li class="" id="Installation">
                            <a href="docs_install.html"> Installation</a>
                        </li>
                        
                        <li class="" id="Creating Forms">
                            <a href="docs_odkformsforomk.html"> Creating Forms</a>
                        </li>
                        
                        <li class="" id="Creating OSM Basemap">
                            <a href="docs_creatingbasemaps.html"> Creating OSM Basemap</a>
                        </li>
                        
                        <li class="" id="Additional Resources">
                            <a href="docs_additionalresources.html"> Additional Resources</a>
                        </li>
                        
                    </ul>
                </li>
                
                <li class="" id="Tutorials">
                    
                        <a href="#"> Tutorials</a>
                    
                    <ul class="open">
                        
                        <li class="" id="Walkthrough">
                            <a href="docs_walkthrough.html"> Walkthrough</a>
                        </li>
                        
                    </ul>
                </li>
                
                <li class="" id="Constraints">
                    
                        <a href="docs_constraints.html"> Constraints</a>
                    
                    <ul class="open">
                        
                    </ul>
                </li>
                
                <li class="" id="Developers">
                    
                        <a href="#"> Developers</a>
                    
                    <ul class="open">
                        
                        <li class="" id="Architecture">
                            <a href="docs_developers.html"> Architecture</a>
                        </li>
                        
                        <li class="" id="Technical Specs">
                            <a href="docs_developers.html"> Technical Specs</a>
                        </li>
                        
                        <li class="" id="Contributing Code">
                            <a href="docs_developers.html"> Contributing Code</a>
                        </li>
                        
                    </ul>
                </li>
                
            </ul>
            
        </li>

        

    </ul>
    </div>
</aside>
<!-- END Sidebar -->

<script type="text/javascript">

    jQuery(window).ready(function() {

        var pathname = window.location.pathname; // Returns path only
        $("#sideBar ul li a").each(function(){
            if (($(this).attr('href')) == pathname){
                $(this).addClass("activeMenu");
//                return false;
            }

        });

    });


</script>


    <article class="col-md-12 col-sm-12 main-content new-sidebar-main-padding" role="main">

        <section>
            <h1 id="constraints">Constraints</h1>

<p>As of the <a href="https://github.com/AmericanRedCross/OpenMapKitAndroid/releases/tag/v1.1">OpenMapKit Android 1.1 release</a>, we have added the functionality known as constraints. In effect, you can configure, both globally and on a form-by-form basis the behavior of the tagging user experience.</p>

<h2 id="configuration-files">Configuration Files</h2>

<p>OpenMapKit Android comes with a <a href="https://github.com/AmericanRedCross/OpenMapKitAndroid/blob/master/app/src/main/assets/constraints/default.json">default.json</a> configuration file as well as an example form-specifc JSON file called <a href="https://github.com/AmericanRedCross/OpenMapKitAndroid/blob/master/app/src/main/assets/constraints/Buildings.json">Buildings.json</a>. These files come with the application, and they are automatically copied from the appâ€™s assets into the OpenMapKit constraints directory in your external storage. You can later edit these files and update the constraints for your custom purposes.</p>

<pre><code>/sdcard/openmapkit/constraints/
</code></pre>

<p>The <code>default.json</code> file defines constraints that are to be applied to all surveys, and the <code>Buildings.json</code> is an example of a form-specific configuration that applies only to the Buildings form.</p>

<p>The form-specific configurations are named after the <strong>form title</strong> of your XLSX form.</p>

<p><img src="images/constraints/1.png" alt="" /></p>

<p>You can also see this title in OpenMapKit Server.</p>

<p><img src="images/constraints/2.png" alt="" /></p>

<h2 id="json-schema">JSON Schema</h2>

<p><a href="https://github.com/AmericanRedCross/OpenMapKitAndroid/blob/master/app/src/main/assets/constraints/default.json">default.json</a> is a good file for you to look at to see how to build your own constraint configuration.</p>

<pre><code class="language-json">{
  "addr:city": {
    "default": "Sacramento"
  },
  "addr:housenumber": {
    "numeric": true
  },
  "addr:state": {
    "default": "CA"
  },
  "addr:postcode": {
    "numeric": true
  },
  "amenity": {
    "hide_if": {
      "building": "residential",
      "shop": true,
      "office": true
    },
    "custom_value": true
  },
  "building": {
    "default": "yes"
  },
  "building:levels": {
    "numeric": true,
    "custom_value": true
  },
  "cuisine": {
    "show_if": {
      "amenity": true
    }
  },
  "network": {
    "select_multiple": true
  },
  "office": {
    "hide_if": {
      "amenity": true,
      "shop": true
    }
  },
  "opening_hours": {
    "select_multiple": true
  },
  "operator": {
    "select_multiple": true,
    "custom_value": true
  },
  "religion": {
    "show_if": {
      "amenity": "place_of_worship"
    }
  },
  "shop": {
    "custom_value": true,
    "hide_if": {
      "building": "residential",
      "amenity": true,
      "office": true
    }
  },
  "source": {
    "implicit": "survey"
  }
}
</code></pre>

<p>It is a simple JSON object where the keys are the names of the OSM tag keys that have constraints applied. The values are the name of the constraint, with the condition of the constraint.</p>

<p>For example, the <code>religion</code> OSM tag is only shown in OpenMapKit Android if you have selected <code>place_of_worship</code> for your <code>amenity</code> tag.</p>

<pre><code class="language-json">"religion": {
	"show_if": {
	  "amenity": "place_of_worship"
	}
}
</code></pre>

<p>Your form-specific JSON files are structured exactly the same, and they take a cascading effect, over-riding constraints for the same tags in <code>default.json</code>.</p>

<h2 id="constraint-types">Constraint Types</h2>

<p>The following are all of the types of constraints you can apply on an OSM tag key.</p>

<h3 id="customvalue">custom_value</h3>

<p>For tags that have a select one or a select many interface, if you enable the <code>custom_value</code> constraint to true, the user can input a custom tag value in addition to the pre-defined choices.</p>

<p class="imageSize"><img src="images/constraints/3.png" alt="Custom Value UI" /></p>

<p>This is a <code>boolean</code> type constraint. You simply have a <code>"custom_value": true</code> for our given OSM tag.</p>

<pre><code class="language-json">"building": {
  "custom_value": true
}
</code></pre>

<h3 id="default">default</h3>

<p>A <code>default</code> constraint for a tag applies a default value for a given OSM tag. The user can change that value if she chooses.</p>

<p class="imageSize"><img src="images/constraints/4.png" alt="default" /></p>

<p>This is a <code>string</code> type constraint.</p>

<pre><code class="language-json">"addr:city": {
  "default": "Sacramento"
}
</code></pre>

<h3 id="hideif">hide_if</h3>

<p>A `hide_if_ constraint for a tag hides the given tag from the user interface if the containing tag exists or has a certain value.</p>

<p>This can be a <code>boolean</code> or a <code>string</code> type constraint. A <code>hide_if</code> constraint can have both. If the constraint condition is <code>true</code>, the constraint applies regardless of what the conditional tag value is. Or, if the constraint condition has a <code>string</code> value, it applies only if the dependent tag key and value is true.</p>

<pre><code class="language-json">"shop": {
  "hide_if": {
    "building": "residential",
    "amenity": true,
    "office": true
  }
}
</code></pre>

<p>This constraint applies for a <code>shop</code>. A <code>shop</code> is hidden if <code>building</code> is <code>residential</code> or if a value is given for <code>amenity</code> or <code>office</code>.</p>

<h3 id="implicit">implicit</h3>

<p>An <code>implicit</code> constraint gives a tag a specified value and does not show the tag in the user interface to the user. The OSM Element is tagged with an implicit key / value with no user intervention.</p>

<p>This is a <code>boolean</code> type constraint.</p>

<pre><code class="language-json">"source": {
  "implicit": "survey"
}
</code></pre>

<h3 id="numeric">numeric</h3>

<p>A <code>numeric</code> constraint makes the numeric keyboard pop up by default for a question. The user still can toggle back to an alpha keyboard.</p>

<p class="imageSize"><img src="images/constraints/5.png" alt="numeric" /></p>

<p>This is a <code>boolean</code> type constraint.</p>

<pre><code class="language-json">"addr:housenumber": {
  "numeric": true
}
</code></pre>

<h3 id="required">required</h3>

<p>A <code>required</code> constraint forces the user to answer a given question. You will know it is a required question when you see <strong>Required</strong> in the top right corner or the screen.</p>

<p class="imageSize"><img src="images/constraints/6.png" alt="required" /></p>

<p>If the user does not answer the tag question, the following Snackbar will divert the user from bouncing back into ODK Collect.</p>

<p class="imageSize"><img src="images/constraints/7.png" alt="required notification" /></p>

<p>Clicking on OK will scroll you to the first missing required tag.</p>

<p>This is a <code>boolean</code> type constraint.</p>

<pre><code class="language-json">"addr:street": {
  "required": true
}
</code></pre>

<h3 id="selectmultiple">select_multiple</h3>

<p>A <code>select_multiple</code> constraint allows the user to select multiple values for a given tag. These tag values are <code>;</code> delimited, and this is the standard OpenStreetMap convention for having multiple values for a tag.</p>

<p class="imageSize"><img src="images/constraints/8.png" alt="select_multiple" /></p>

<p>This is a <code>boolean</code> type constraint.</p>

<pre><code class="language-json">"network": {
  "select_multiple": true
}
</code></pre>

<h3 id="showif">show_if</h3>

<p><code>show_if</code> is the opposite of <code>hide_if</code>. A tag is hidden unless the constraint condition is met.</p>

<pre><code class="language-json">"religion": {
  "show_if": {
    "amenity": "place_of_worship"
  }
}
</code></pre>

<p>In this example, the <code>religion</code> tag is only shown if the <code>amenity</code> is a <code>place_of_worship</code>.</p>

<p>This is a <code>boolean</code> or <code>string</code> type constraint.</p>

        </section>

    </article>

</div>


</div>

<div id='footer'>
    <div class='row footer-spacing'>
        <div class='small-12 medium-12 large-12 column group'>
            <div class="row">
                <!-- ARC logo -->
                <div class="small-12 medium-3 large-2 column inline-flex logo-width">
                    <a class="logo" href='http://www.redcross.org' target="_blank">
                        <img src="images/logo_RC.png" class="footer-logo"/>
                    </a>
                </div>

                <!-- Social Media Links -->
                <div class="small-12 medium-3 large-2 column social-media">
                    <ul class='socials'>
                        <li class="pull-left">
                            <a href='https://twitter.com/openmapkit' target="_blank">
                                <i class='fa fa-twitter mini-icon'></i>
                            </a>
                        </li>
                        <li class="pull-left">
                            <a href='https://github.com/AmericanRedCross/OpenMapKitAndroid' target="_blank">
                                <i class='fa fa-github mini-icon'></i>
                            </a>
                        </li>
                    </ul>
                </div>

                <div class="small-6 column">

                    <div class="row">

                        <!-- Social Media Links -->
                        <div class="small-12 medium-12 large-12 column social-media-mobile">
                            <ul class='socials'>
                                <li class="pull-right">
                                    <a href='https://twitter.com/openmapkit' target="_blank">
                                        <i class='fa fa-twitter mini-icon'></i>
                                    </a>
                                </li>
                                <li class="pull-right">
                                    <a href='https://github.com/AmericanRedCross/OpenMapKitAndroid' target="_blank">
                                        <i class='fa fa-github mini-icon'></i>
                                    </a>
                                </li>
                            </ul>
                        </div>

                        <!-- License -->
                        <div class="small-12 medium-12 large-12 column license-align">
                            <a target="_blank" class="license pull-right" rel="license" href="http://creativecommons.org/licenses/by/4.0/">
                                <img alt="Creative Commons License" style="border-width:0" src="../images/ccby.svg"/>
                            </a>
                        </div>

                    </div>

                </div>

            </div>
        </div>
    </div>
</div>

<script src="javascripts/jquery.countTo.js" type="text/javascript"></script>
<script src="javascripts/jquery.appear.js" type="text/javascript"></script>
<script src="javascripts/jquery.validate.js" type="text/javascript"></script>
<script src="javascripts/jquery.sequence-min.js" type="text/javascript"></script>
<script src="javascripts/jquery.easing.1.3.js" type="text/javascript"></script>
<script src="javascripts/app.js" type="text/javascript"></script>
<script src="javascripts/jquery.min.js" type="text/javascript"></script>
<script src="javascripts/matchHeight.min.js" type="text/javascript"></script>
<script src="javascripts/clipboard.min.js" type="text/javascript"></script>
<script src="javascripts/jquery.fitvids.js" type="text/javascript"></script>
<script src="javascripts/bootstrap.min.js" type="text/javascript"></script>
<script src="javascripts/theDocs.js" type="text/javascript"></script>

<script src="javascripts/docs.js" type="text/javascript"></script>


</body>

</html>
